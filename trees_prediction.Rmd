---
title: "тексты"
date: "05 10 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F)
library(tidyverse)
library(quanteda)
library(stringr)
library(caret)
```

## Gender prediction
```{r}
#load("~/russian-twitter/data2.RData")
#names(getModelInfo())

## параметры обучения: 10-fold кросс-валидация
ctrl <- trainControl(method="cv", 10, verboseIter=TRUE)

#model.lr <- train(train.data, train.df$sex, method="glmnet", family="binomial", trControl=ctrl)

df_sex = cbind(sex = train.df$sex, train.data) 

fit.ctree <- train(sex ~ .-sex, data = df_sex, method='ctree', trControl=ctrl)
fit.ctree

#plot(fit.ctree)
ctreeVarImp = varImp(fit.ctree)
```

Predicting life stage
```{r}
df_stage <- cbind(life_stage = train.df$life_stage, train.data) 
df_stage <- na.omit(df_stage)
fit.ctree2 <- train(life_stage ~ .-life_stage, data = df_stage, method='ctree', trControl=ctrl)
fit.ctree2

#plot(fit.ctree)
ctreeVarImp = varImp(fit.ctree)
save.image("~/russian-twitter/data3.RData")
```


```{r}
load("/students/aabakhitova/russian-twitter/data3.RData")
```

